import"../chunks/CWj6FrbW.js";import{i as Rt}from"../chunks/DhkT2eu7.js";import{a as Ct,l as Dt,o as Nt,b as yt,e as Me,s as ie}from"../chunks/DSBcQFgc.js";import{a1 as Ot,b as Ht,ax as vt,s as Te,h as I,S as xt,a as It,w as e,aj as xe,r as $t,c as Gt,d as je,e as ke,i as fe,T as Kt,X as Bt,f as ut,g as ct,p as Jt,ay as Le,$ as ht,O as Ut,M as et,az as Ie,aA as tt,aB as $e,ao as T,aC as at,aD as Vt,aE as Yt,_ as Pt,aF as qt,aG as Ft,aH as Qt,V as Wt,Q as Xt,aI as Zt,aJ as jt,aK as ea,aL as ta,t as te,ae as aa,A as ra,aM as X,aN as la,B as G,k as Re,C as ee,m as x,D as na,an as f,aO as rt,I as D,F as R,G as w,ac as sa,j as lt}from"../chunks/BeFNWfIg.js";import{i as Ce}from"../chunks/DL-bkZpP.js";function V(t,a){return a}function ia(t,a,r,l){for(var i=[],v=a.length,S=0;S<v;S++)Yt(a[S].e,i,!0);var p=v>0&&i.length===0&&r!==null;if(p){var m=r.parentNode;Pt(m),m.append(r),l.clear(),q(t,a[0].prev,a[v-1].next)}qt(i,()=>{for(var c=0;c<v;c++){var u=a[c];p||(l.delete(u.k),q(t,u.prev,u.next)),Ft(u.e,!p)}})}function Y(t,a,r,l,i,v=null){var S=t,p={flags:a,items:new Map,first:null},m=(a&vt)!==0;if(m){var c=t;S=I?Te(xt(c)):c.appendChild(Ot())}I&&It();var u=null,_=!1,g=xe(()=>{var E=r();return Xt(E)?E:E==null?[]:ht(E)});Ht(()=>{var E=e(g),h=E.length;if(_&&h===0)return;_=h===0;let H=!1;if(I){var k=$t(S)===Gt;k!==(h===0)&&(S=je(),Te(S),ke(!1),H=!0)}if(I){for(var L=null,y,C=0;C<h;C++){if(fe.nodeType===Kt&&fe.data===Bt){S=fe,H=!0,ke(!1);break}var b=E[C],A=l(b,C);y=dt(fe,p,L,null,b,A,C,i,a,r),p.items.set(A,y),L=y}h>0&&Te(je())}I||fa(E,p,S,i,a,l,r),v!==null&&(h===0?u?ut(u):u=ct(()=>v(S)):u!==null&&Jt(u,()=>{u=null})),H&&ke(!0),e(g)}),I&&(S=fe)}function fa(t,a,r,l,i,v,S){var ue,ce,K,B;var p=(i&Vt)!==0,m=(i&(Ie|$e))!==0,c=t.length,u=a.items,_=a.first,g=_,E,h=null,H,k=[],L=[],y,C,b,A;if(p)for(A=0;A<c;A+=1)y=t[A],C=v(y,A),b=u.get(C),b!==void 0&&((ue=b.a)==null||ue.measure(),(H??(H=new Set)).add(b));for(A=0;A<c;A+=1){if(y=t[A],C=v(y,A),b=u.get(C),b===void 0){var F=g?g.e.nodes_start:r;h=dt(F,a,h,h===null?a.first:h.next,y,C,A,l,i,S),u.set(C,h),k=[],L=[],g=h.next;continue}if(m&&oa(b,y,A,i),(b.e.f&Le)!==0&&(ut(b.e),p&&((ce=b.a)==null||ce.unfix(),(H??(H=new Set)).delete(b))),b!==g){if(E!==void 0&&E.has(b)){if(k.length<L.length){var Z=L[0],$;h=Z.prev;var oe=k[0],ae=k[k.length-1];for($=0;$<k.length;$+=1)nt(k[$],Z,r);for($=0;$<L.length;$+=1)E.delete(L[$]);q(a,oe.prev,ae.next),q(a,h,oe),q(a,ae,Z),g=Z,h=ae,A-=1,k=[],L=[]}else E.delete(b),nt(b,g,r),q(a,b.prev,b.next),q(a,b,h===null?a.first:h.next),q(a,h,b),h=b;continue}for(k=[],L=[];g!==null&&g.k!==C;)(g.e.f&Le)===0&&(E??(E=new Set)).add(g),L.push(g),g=g.next;if(g===null)continue;b=g}k.push(b),h=b,g=b.next}if(g!==null||E!==void 0){for(var Q=E===void 0?[]:ht(E);g!==null;)(g.e.f&Le)===0&&Q.push(g),g=g.next;var re=Q.length;if(re>0){var ve=(i&vt)!==0&&c===0?r:null;if(p){for(A=0;A<re;A+=1)(K=Q[A].a)==null||K.measure();for(A=0;A<re;A+=1)(B=Q[A].a)==null||B.fix()}ia(a,Q,ve,u)}}p&&Ut(()=>{var le;if(H!==void 0)for(b of H)(le=b.a)==null||le.apply()}),et.first=a.first&&a.first.e,et.last=h&&h.e}function oa(t,a,r,l){(l&Ie)!==0&&tt(t.v,a),(l&$e)!==0?tt(t.i,r):t.i=r}function dt(t,a,r,l,i,v,S,p,m,c){var u=(m&Ie)!==0,_=(m&Qt)===0,g=u?_?T(i,!1,!1):at(i):i,E=(m&$e)===0?S:at(S),h={i:E,v:g,k:v,a:null,e:null,prev:r,next:l};try{return h.e=ct(()=>p(t,g,E,c),I),h.e.prev=r&&r.e,h.e.next=l&&l.e,r===null?a.first=h:(r.next=h,r.e.next=h.e),l!==null&&(l.prev=h,l.e.prev=h.e),h}finally{}}function nt(t,a,r){for(var l=t.next?t.next.e.nodes_start:r,i=a?a.e.nodes_start:r,v=t.e.nodes_start;v!==l;){var S=Wt(v);i.before(v),v=S}}function q(t,a,r){a===null?t.first=r:(a.next=r,a.e.next=r&&r.e),r!==null&&(r.prev=a,r.e.prev=a&&a.e)}function va(t,a,r){var l=t==null?"":""+t;return l=l?l+" "+a:a,l===""?null:l}function st(t,a=!1){var r=a?" !important;":";",l="";for(var i in t){var v=t[i];v!=null&&v!==""&&(l+=" "+i+": "+v+r)}return l}function ua(t,a){if(a){var r="",l,i;return Array.isArray(a)?(l=a[0],i=a[1]):l=a,l&&(r+=st(l)),i&&(r+=st(i,!0)),r=r.trim(),r===""?null:r}return String(t)}function De(t,a,r,l,i,v){var S=t.__className;if(I||S!==r||S===void 0){var p=va(r,l);(!I||p!==t.getAttribute("class"))&&(p==null?t.removeAttribute("class"):t.className=p),t.__className=r}return v}function Ne(t,a={},r,l){for(var i in r){var v=r[i];a[i]!==v&&(r[i]==null?t.style.removeProperty(i):t.style.setProperty(i,v,l))}}function ca(t,a,r,l){var i=t.__style;if(I||i!==a){var v=ua(a,l);(!I||v!==t.getAttribute("style"))&&(v==null?t.removeAttribute("style"):t.style.cssText=v),t.__style=a}else l&&(Array.isArray(l)?(Ne(t,r==null?void 0:r[0],l[0]),Ne(t,r==null?void 0:r[1],l[1],"important")):Ne(t,r,l));return l}const ha=Symbol("is custom element"),da=Symbol("is html");function _a(t){if(I){var a=!1,r=()=>{if(!a){if(a=!0,t.hasAttribute("value")){var l=t.value;it(t,"value",null),t.value=l}if(t.hasAttribute("checked")){var i=t.checked;it(t,"checked",null),t.checked=i}}};t.__on_r=r,Zt(r),Ct()}}function it(t,a,r,l){var i=pa(t);I&&(i[a]=t.getAttribute(a),a==="src"||a==="srcset"||a==="href"&&t.nodeName==="LINK")||i[a]!==(i[a]=r)&&(a==="loading"&&(t[jt]=r),t.removeAttribute(a))}function pa(t){return t.__attributes??(t.__attributes={[ha]:t.nodeName.includes("-"),[da]:t.namespaceURI===ea})}function ga(t,a,r=a){var l=ta();Dt(t,"input",i=>{var v=i?t.defaultValue:t.value;if(v=ye(t)?Oe(v):v,r(v),l&&v!==(v=a())){var S=t.selectionStart,p=t.selectionEnd;t.value=v??"",p!==null&&(t.selectionStart=S,t.selectionEnd=Math.min(p,t.value.length))}}),(I&&t.defaultValue!==t.value||te(a)==null&&t.value)&&r(ye(t)?Oe(t.value):t.value),aa(()=>{var i=a();ye(t)&&i===Oe(t.value)||t.type==="date"&&!i&&!t.value||i!==t.value&&(t.value=i??"")})}function ye(t){var a=t.type;return a==="number"||a==="range"}function Oe(t){return t===""?null:+t}function ft(t=10,a=20){return Array.from({length:a},()=>Array(t).fill(0))}const ma={I:[[1,1,1,1]],O:[[1,1],[1,1]],T:[[0,1,0],[1,1,1]],S:[[0,1,1],[1,1,0]],Z:[[1,1,0],[0,1,1]],J:[[1,0,0],[1,1,1]],L:[[0,0,1],[1,1,1]]};function _t(t){return t[0].map((a,r)=>t.map(l=>l[r]).reverse())}function ba(t){return t[0].map((a,r)=>t.map(l=>l[l.length-1-r]))}function ot(t,a=0){let r=ma[t].map(l=>[...l]);for(let l=0;l<a;l++)r=_t(r);return r}function pe(){const t=["I","O","T","S","Z","J","L"];return t[Math.floor(Math.random()*t.length)]}function He(){return Math.floor(Math.random()*4)}function Sa(t){function a(r){switch(r.code){case"ArrowLeft":t.moveLeft(),r.preventDefault();break;case"ArrowRight":t.moveRight(),r.preventDefault();break;case"Space":t.hardDrop(),r.preventDefault();break;case"ArrowUp":t.rotateRight(),r.preventDefault();break;case"ArrowDown":t.softDrop(),r.preventDefault();break;case"ShiftLeft":case"ShiftRight":case"KeyQ":t.hold(),r.preventDefault();break}}return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)}const pt="tetris_highscores";function ge(){if(typeof localStorage>"u")return[];const t=localStorage.getItem(pt);if(!t)return[];try{return JSON.parse(t)}catch{return[]}}function za(t){const a=ge();a.push(t),a.sort((l,i)=>i.score-l.score);const r=a.slice(0,10);localStorage.setItem(pt,JSON.stringify(r))}var Aa=G('<div class="game-over-overlay svelte-hfif0z"><div class="game-over-box svelte-hfif0z"><div class="game-over-title svelte-hfif0z">Game Over</div> <div class="final-score svelte-hfif0z"> </div> <input type="text" placeholder="Your name" maxlength="12" class="name-input svelte-hfif0z"/> <button class="save-score-btn svelte-hfif0z">Save Score</button> <button class="try-again-btn svelte-hfif0z">Try Again</button></div></div>'),wa=G("<td></td>"),Ea=G('<tr class="svelte-hfif0z"></tr>'),Ma=G('<td class="hold-cell svelte-hfif0z"></td>'),Ta=G('<tr class="svelte-hfif0z"></tr>'),ka=G("<td></td>"),La=G('<tr class="svelte-hfif0z"></tr>'),Ra=G("<td></td>"),Ca=G('<tr class="svelte-hfif0z"></tr>'),Da=G('<li class="svelte-hfif0z"><span class="hs-rank svelte-hfif0z"></span> <span class="hs-name svelte-hfif0z"> </span> <span class="hs-score svelte-hfif0z"> </span></li>'),Na=G('<li class="no-scores svelte-hfif0z">No scores yet</li>'),ya=G('<!> <div class="centered svelte-hfif0z"><div class="tetris-container svelte-hfif0z"><div class="hold-shape-box svelte-hfif0z"><div class="hold-label svelte-hfif0z">Hold</div> <table class="hold-shape-table svelte-hfif0z"><tbody class="svelte-hfif0z"><!></tbody></table> <button class="svelte-hfif0z">Hold (Q/Shift)</button></div> <table class="background svelte-hfif0z"><tbody class="svelte-hfif0z"></tbody></table> <div class="svelte-hfif0z"><div class="next-shape-box svelte-hfif0z"><div class="next-label svelte-hfif0z">Next</div> <table class="next-shape-table svelte-hfif0z"><tbody class="svelte-hfif0z"></tbody></table> <div class="score-label svelte-hfif0z">Score</div> <div class="score-value svelte-hfif0z"> </div> <div class="score-label svelte-hfif0z">Level</div> <div class="score-value svelte-hfif0z"> </div></div> <div class="highscore-box svelte-hfif0z"><div class="highscore-title svelte-hfif0z">Highscores</div> <ol class="highscore-list svelte-hfif0z"><!> <!></ol></div></div></div></div>',1);function Ka(t,a){ra(a,!1);const r=T(),l=T(),i=T(),v=10,S=20;let p=T(ft(v,S)),m=T(!1),c=T([]),u=T(0),_=T(0),g=T(1),E=0,h=T(pe()),H=T(He()),k,L,y=null,C=!0;function b(){C?(C=!1,L=pe()):(L=e(h),k=e(H),f(h,pe()),f(H,He())),f(c,ot(L,k)),f(u,-1),f(_,Math.floor((v-e(c)[0].length)/2)),f(m,!0),A()}function A(){F();const n=Math.max(500-(e(g)-1)*40,50);y=setInterval(()=>{e(m)&&(K(e(u)+1,e(_))?f(u,e(u)+1):(le(),F()))},n)}function F(){y!==null&&(clearInterval(y),y=null)}function Z(n,s){if(!e(m))return!1;for(let d=0;d<e(c).length;d++)for(let o=0;o<e(c)[0].length;o++)if(e(c)[d][o]&&n===e(u)+d&&s===e(_)+o)return!0;return!1}let $=null;function oe(){e(m)&&K(e(u),e(_)-1)&&f(_,e(_)-1)}function ae(){e(m)&&K(e(u),e(_)+1)&&f(_,e(_)+1)}function Q(){if(e(m)){for(;K(e(u)+1,e(_));)f(u,e(u)+1);le(),F()}}function re(){e(m)&&K(e(u)+1,e(_))&&(f(u,e(u)+1),f(P,e(P)+1))}function ve(n){if(K(e(u),e(_),n))return f(c,n),!0;for(let s of[-1,1,-2,2])if(K(e(u),e(_)+s,n))return f(_,e(_)+s),f(c,n),!0;return!1}function ue(){if(!e(m))return;const n=_t(e(c));ve(n)}function ce(){if(!e(m))return;const n=ba(e(c));ve(n)}function K(n,s,d=e(c)){for(let o=0;o<d.length;o++)for(let M=0;M<d[0].length;M++)if(d[o][M]){const z=n+o,N=s+M;if(z<0||z>=S||N<0||N>=v||e(p)[z][N]!==0)return!1}return!0}Nt(()=>{$=Sa({moveLeft:oe,moveRight:ae,hardDrop:Q,rotateRight:ue,rotateLeft:ce,hold:Ge,softDrop:re})}),yt(()=>{F(),$&&$()});let B=T(!1);function le(){let n=!1;for(let s=0;s<e(c).length;s++)for(let d=0;d<e(c)[0].length;d++)if(e(c)[s][d]){const o=e(u)+s,M=e(_)+d;o<0||o>=S||M<0||M>=v?n=!0:rt(p,e(p)[o][M]=1)}gt(),f(m,!1),f(ne,!1),(n||e(p)[0].some(s=>s===1))&&(f(B,!0),F())}let P=T(0),he=T([]);async function gt(){let n=[];for(let s=0;s<e(p).length;s++)e(p)[s].every(d=>d===1)&&n.push(s);if(n.length>0){f(he,n),await sa(),await new Promise(o=>setTimeout(o,350));let s=[];for(let o=0;o<e(p).length;o++)n.includes(o)||s.push([...e(p)[o]]);for(;s.length<S;)s.unshift(Array(v).fill(0));f(p,s),f(he,[]);const d=[0,100,300,500,800];f(P,e(P)+(d[n.length]||n.length*200)*(e(g)+1)),E+=n.length,f(g,Math.floor(E/10)+1)}}let O=T(null),de=null,_e=null,ne=T(!1);function Ge(){if(!(e(ne)||!e(m)))if(f(ne,!0),!e(O))f(O,e(c).map(n=>[...n])),de=L,_e=k,f(m,!1);else{const n=e(O),s=de,d=_e;f(O,e(c).map(o=>[...o])),de=L,_e=k,L=s,k=d,f(c,n.map(o=>[...o])),f(u,-1),f(_,Math.floor((v-e(c)[0].length)/2))}}function mt(){f(p,ft(v,S)),f(P,0),f(m,!1),f(c,[]),f(u,0),f(_,0),f(h,pe()),f(H,He()),k=void 0,L=void 0,f(O,null),de=null,_e=null,f(ne,!1),C=!0,f(B,!1),f(g,1),E=0}let se=T([]),W=T(""),j=T(!1);function bt(){!e(j)||!e(W).trim()||(za({name:e(W).trim().slice(0,12),score:e(P)}),f(se,ge()),f(j,!1))}X(()=>(e(m),e(u),e(_)),()=>{f(r,(()=>{if(!e(m))return 0;let n=e(u);for(;K(n+1,e(_));)n+=1;return n})())}),X(()=>(e(u),e(_),e(c),e(r),e(p),e(m)),()=>{f(l,(e(u),e(_),e(c),e(r),e(p).map((n,s)=>n.map((d,o)=>e(m)&&s>=e(r)&&s<e(r)+e(c).length&&o>=e(_)&&o<e(_)+e(c)[0].length&&e(c)[s-e(r)][o-e(_)]&&!(s>=e(u)&&s<e(u)+e(c).length&&o>=e(_)&&o<e(_)+e(c)[0].length&&e(c)[s-e(u)][o-e(_)])?3:Z(s,o)?2:d))))}),X(()=>(e(h),e(H)),()=>{f(i,ot(e(h),e(H)))}),X(()=>(e(m),e(B)),()=>{!e(m)&&!e(B)&&b()}),X(()=>e(O),()=>{if(e(O)){Math.floor((v-e(O)[0].length)/2);for(let n=0;n<e(O).length;n++)for(let s=0;s<e(O)[0].length;s++)e(O)[n][s]&&rt(O,e(O)[n][s]=1)}}),X(()=>ge,()=>{f(se,ge())}),X(()=>e(B),()=>{e(B)&&(f(j,!0),f(W,""))}),la(),Rt();var Ke=ya(),Be=Re(Ke);{var St=n=>{var s=Aa(),d=R(s),o=D(R(d),2),M=R(o);w(o);var z=D(o,2);_a(z);var N=D(z,2),J=D(N,2);w(d),w(s),ee(U=>{ie(M,`Score: ${e(P)??""}`),z.disabled=!e(j),N.disabled=U},[()=>(e(j),e(W),te(()=>!e(j)||!e(W).trim()))],xe),ga(z,()=>e(W),U=>f(W,U)),Me("click",N,bt),Me("click",J,mt),x(n,s)};Ce(Be,n=>{e(B)&&n(St)})}var me=D(Be,2);let Je;var Ue=R(me),be=R(Ue),Se=D(R(be),2),Ve=R(Se),zt=R(Ve);{var At=n=>{var s=lt(),d=Re(s);Y(d,1,()=>e(O),V,(o,M)=>{var z=Ea();Y(z,5,()=>e(M),V,(N,J)=>{var U=wa();ee(()=>De(U,1,`hold-cell ${e(J)?"active":""}`,"svelte-hfif0z")),x(N,U)}),w(z),x(o,z)}),x(n,s)},wt=n=>{var s=lt(),d=Re(s);Y(d,0,()=>Array(4),V,(o,M)=>{var z=Ta();Y(z,4,()=>Array(4),V,(N,J,U,Oa)=>{var Lt=Ma();x(N,Lt)}),w(z),x(o,z)}),x(n,s)};Ce(zt,n=>{e(O)?n(At):n(wt,!1)})}w(Ve),w(Se);var Ye=D(Se,2);w(be);var ze=D(be,2),Pe=R(ze);Y(Pe,5,()=>e(l),V,(n,s,d)=>{var o=La();Y(o,5,()=>e(s),V,(M,z)=>{var N=ka();ee(J=>De(N,1,`box
                                ${e(z)===2?" active":""}
                                ${e(z)===1?" fixed":""}
                                ${e(z)===3?" ghost":""}
                                ${J??""}`,"svelte-hfif0z"),[()=>(e(he),e(z),te(()=>e(he).includes(d)&&e(z)===1?" blinking":""))],xe),x(M,N)}),w(o),x(n,o)}),w(Pe),w(ze);var qe=D(ze,2),Ae=R(qe),we=D(R(Ae),2),Fe=R(we);Y(Fe,5,()=>e(i),V,(n,s)=>{var d=Ca();Y(d,5,()=>e(s),V,(o,M)=>{var z=Ra();ee(()=>De(z,1,`next-cell ${e(M)?"active":""}`,"svelte-hfif0z")),x(o,z)}),w(d),x(n,d)}),w(Fe),w(we);var Ee=D(we,4),Et=R(Ee,!0);w(Ee);var Qe=D(Ee,4),Mt=R(Qe,!0);w(Qe),w(Ae);var We=D(Ae,2),Xe=D(R(We),2),Ze=R(Xe);Y(Ze,1,()=>e(se),V,(n,s,d)=>{var o=Da(),M=R(o);M.textContent=`${d+1}.`;var z=D(M,2),N=R(z,!0);w(z);var J=D(z,2),U=R(J,!0);w(J),w(o),ee(()=>{ie(N,(e(s),te(()=>e(s).name))),ie(U,(e(s),te(()=>e(s).score)))}),x(n,o)});var Tt=D(Ze,2);{var kt=n=>{var s=Na();x(n,s)};Ce(Tt,n=>{e(se),te(()=>e(se).length===0)&&n(kt)})}w(Xe),w(We),w(qe),w(Ue),w(me),ee(()=>{Je=ca(me,"",Je,{filter:e(B)?"blur(3px)":""}),Ye.disabled=e(ne)||!e(m),ie(Et,e(P)),ie(Mt,e(g))}),Me("click",Ye,Ge),x(t,Ke),na()}export{Ka as component};
